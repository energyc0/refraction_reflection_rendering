<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libktx Reference: glloader.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="ktx_logo_200.png"/></td>
  <td id="projectalign">
   <div id="projectname">libktx Reference<span id="projectnumber">&#160;4.3.2</span>
   </div>
   <div id="projectbrief">Libraries and tools to create and read KTX image texture files.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('glloader_8c-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">glloader.c</div></div>
</div><!--header-->
<div class="contents">
<p>This is an example of using the low-level <a class="el" href="structktxTexture.html" title="Base class representing a texture.">ktxTexture</a> API to create and load an OpenGL texture. It is a fragment of the code used by <a class="el" href="group__ktx__glloader.html#ga058297b66c5a7fd1f1bbaf718a887b9f">ktxTexture1_GLUpload</a> and <a class="el" href="group__ktx__glloader.html#ga7624860df8e44573862fa5754ea2976c">ktxTexture2_GLUpload</a>.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;ktx.h&gt;</span></div>
</div><!-- fragment --><p>This structure is used to pass to a callback function data that is uniform across all images. </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>ktx_cbdata {</div>
<div class="line">    GLenum glTarget;</div>
<div class="line">    GLenum glFormat;</div>
<div class="line">    GLenum glInternalformat;</div>
<div class="line">    GLenum glType;</div>
<div class="line">    GLenum glError;</div>
<div class="line">    GLuint numLayers;</div>
<div class="line">} ktx_cbdata;</div>
</div><!-- fragment --><p>One of these callbacks, selected by <a class="el" href="group__ktx__glloader.html#ga058297b66c5a7fd1f1bbaf718a887b9f">ktxTexture1_GLUpload</a> or <a class="el" href="group__ktx__glloader.html#ga7624860df8e44573862fa5754ea2976c">ktxTexture2_GLUpload</a> based on the dimensionality and arrayness of the texture, is called from <a class="el" href="group__reader.html#gae7c4b8bbe26379f2076f93050c0673c1">ktxTexture_IterateLevelFaces</a> to upload the texture data to OpenGL. </p><div class="fragment"><div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">texImage1DCallback(<span class="keywordtype">int</span> miplevel, <span class="keywordtype">int</span> face,</div>
<div class="line">                   <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,</div>
<div class="line">                   <span class="keywordtype">int</span> depth,</div>
<div class="line">                   ktx_uint64_t faceLodSize,</div>
<div class="line">                   <span class="keywordtype">void</span>* pixels, <span class="keywordtype">void</span>* userdata)</div>
<div class="line">{</div>
<div class="line">    ktx_cbdata* cbData = (ktx_cbdata*)userdata;</div>
<div class="line">    UNUSED(faceLodSize);</div>
<div class="line">    UNUSED(depth);</div>
<div class="line">    UNUSED(height);</div>
<div class="line"> </div>
<div class="line">    assert(gl.glTexImage1D != NULL);</div>
<div class="line">    gl.glTexImage1D(cbData-&gt;glTarget + face, miplevel,</div>
<div class="line">                   cbData-&gt;glInternalformat, width, 0,</div>
<div class="line">                   cbData-&gt;glFormat, cbData-&gt;glType, pixels);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((cbData-&gt;glError = glGetError()) == GL_NO_ERROR) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_SUCCESS;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_GL_ERROR;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">compressedTexImage1DCallback(<span class="keywordtype">int</span> miplevel, <span class="keywordtype">int</span> face,</div>
<div class="line">                             <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,</div>
<div class="line">                             <span class="keywordtype">int</span> depth,</div>
<div class="line">                             ktx_uint64_t faceLodSize,</div>
<div class="line">                             <span class="keywordtype">void</span>* pixels, <span class="keywordtype">void</span>* userdata)</div>
<div class="line">{</div>
<div class="line">    ktx_cbdata* cbData = (ktx_cbdata*)userdata;</div>
<div class="line">    UNUSED(depth);</div>
<div class="line">    UNUSED(height);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (faceLodSize &gt; UINT32_MAX)</div>
<div class="line">        <span class="keywordflow">return</span> KTX_INVALID_OPERATION; <span class="comment">// Too big for OpenGL {,ES}.</span></div>
<div class="line"> </div>
<div class="line">    assert(gl.glCompressedTexImage1D != NULL);</div>
<div class="line">    gl.glCompressedTexImage1D(cbData-&gt;glTarget + face, miplevel,</div>
<div class="line">                             cbData-&gt;glInternalformat, width, 0,</div>
<div class="line">                             (ktx_uint32_t)faceLodSize, pixels);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((cbData-&gt;glError = glGetError()) == GL_NO_ERROR) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_SUCCESS;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_GL_ERROR;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">texImage2DCallback(<span class="keywordtype">int</span> miplevel, <span class="keywordtype">int</span> face,</div>
<div class="line">                   <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,</div>
<div class="line">                   <span class="keywordtype">int</span> depth,</div>
<div class="line">                   ktx_uint64_t faceLodSize,</div>
<div class="line">                   <span class="keywordtype">void</span>* pixels, <span class="keywordtype">void</span>* userdata)</div>
<div class="line">{</div>
<div class="line">    ktx_cbdata* cbData = (ktx_cbdata*)userdata;</div>
<div class="line">    UNUSED(depth);</div>
<div class="line">    UNUSED(faceLodSize);</div>
<div class="line"> </div>
<div class="line">    glTexImage2D(cbData-&gt;glTarget + face, miplevel,</div>
<div class="line">                 cbData-&gt;glInternalformat, width,</div>
<div class="line">                 cbData-&gt;numLayers == 0 ? (GLuint)height : cbData-&gt;numLayers, 0,</div>
<div class="line">                 cbData-&gt;glFormat, cbData-&gt;glType, pixels);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((cbData-&gt;glError = glGetError()) == GL_NO_ERROR) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_SUCCESS;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_GL_ERROR;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">compressedTexImage2DCallback(<span class="keywordtype">int</span> miplevel, <span class="keywordtype">int</span> face,</div>
<div class="line">                             <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,</div>
<div class="line">                             <span class="keywordtype">int</span> depth,</div>
<div class="line">                             ktx_uint64_t faceLodSize,</div>
<div class="line">                             <span class="keywordtype">void</span>* pixels, <span class="keywordtype">void</span>* userdata)</div>
<div class="line">{</div>
<div class="line">    ktx_cbdata* cbData = (ktx_cbdata*)userdata;</div>
<div class="line">    GLenum glerror;</div>
<div class="line">    KTX_error_code result;</div>
<div class="line">    UNUSED(depth);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (faceLodSize &gt; UINT32_MAX)</div>
<div class="line">        <span class="keywordflow">return</span> KTX_INVALID_OPERATION; <span class="comment">// Too big for OpenGL {,ES}.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// It is simpler to just attempt to load the format, rather than divine</span></div>
<div class="line">    <span class="comment">// which formats are supported by the implementation. In the event of an</span></div>
<div class="line">    <span class="comment">// error, software unpacking can be attempted.</span></div>
<div class="line">    glCompressedTexImage2D(cbData-&gt;glTarget + face, miplevel,</div>
<div class="line">                           cbData-&gt;glInternalformat, width,</div>
<div class="line">                           cbData-&gt;numLayers == 0 ? (GLuint)height : cbData-&gt;numLayers,</div>
<div class="line">                           0,</div>
<div class="line">                           (ktx_uint32_t)faceLodSize, pixels);</div>
<div class="line"> </div>
<div class="line">    glerror = glGetError();</div>
<div class="line"><span class="preprocessor">#if SUPPORT_SOFTWARE_ETC_UNPACK</span></div>
<div class="line">    <span class="comment">// Renderion is returning INVALID_VALUE. Oops!!</span></div>
<div class="line">    <span class="keywordflow">if</span> ((glerror == GL_INVALID_ENUM || glerror == GL_INVALID_VALUE)</div>
<div class="line">        &amp;&amp; (cbData-&gt;glInternalformat == GL_ETC1_RGB8_OES</div>
<div class="line">            || (cbData-&gt;glInternalformat &gt;= GL_COMPRESSED_R11_EAC</div>
<div class="line">                &amp;&amp; cbData-&gt;glInternalformat &lt;= GL_COMPRESSED_SRGB8_ALPHA8_ETC2_EAC)</div>
<div class="line">            ))</div>
<div class="line">    {</div>
<div class="line">        GLubyte* unpacked;</div>
<div class="line">        GLenum format, internalformat, type;</div>
<div class="line"> </div>
<div class="line">        result = _ktxUnpackETC((GLubyte*)pixels, cbData-&gt;glInternalformat,</div>
<div class="line">                                  width, height, &amp;unpacked,</div>
<div class="line">                                  &amp;format, &amp;internalformat,</div>
<div class="line">                                  &amp;type, R16Formats, supportsSRGB);</div>
<div class="line">        <span class="keywordflow">if</span> (result != KTX_SUCCESS) {</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (!(sizedFormats &amp; _NON_LEGACY_FORMATS)) {</div>
<div class="line">            <span class="keywordflow">if</span> (internalformat == GL_RGB8)</div>
<div class="line">                internalformat = GL_RGB;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (internalformat == GL_RGBA8)</div>
<div class="line">                internalformat = GL_RGBA;</div>
<div class="line">        }</div>
<div class="line">        glTexImage2D(cbData-&gt;glTarget + face, miplevel,</div>
<div class="line">                     internalformat, width,</div>
<div class="line">                     cbData-&gt;numLayers == 0 ? (GLuint)height : cbData-&gt;numLayers, 0,</div>
<div class="line">                     format, type, unpacked);</div>
<div class="line"> </div>
<div class="line">        free(unpacked);</div>
<div class="line">        glerror = glGetError();</div>
<div class="line">    }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((cbData-&gt;glError = glerror) == GL_NO_ERROR) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_SUCCESS;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_GL_ERROR;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">texImage3DCallback(<span class="keywordtype">int</span> miplevel, <span class="keywordtype">int</span> face,</div>
<div class="line">                   <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,</div>
<div class="line">                   <span class="keywordtype">int</span> depth,</div>
<div class="line">                   ktx_uint64_t faceLodSize,</div>
<div class="line">                   <span class="keywordtype">void</span>* pixels, <span class="keywordtype">void</span>* userdata)</div>
<div class="line">{</div>
<div class="line">    ktx_cbdata* cbData = (ktx_cbdata*)userdata;</div>
<div class="line">    UNUSED(faceLodSize);</div>
<div class="line"> </div>
<div class="line">    assert(gl.glTexImage3D != NULL);</div>
<div class="line">    gl.glTexImage3D(cbData-&gt;glTarget + face, miplevel,</div>
<div class="line">                   cbData-&gt;glInternalformat,</div>
<div class="line">                   width, height,</div>
<div class="line">                   cbData-&gt;numLayers == 0 ? (GLuint)depth : cbData-&gt;numLayers,</div>
<div class="line">                   0,</div>
<div class="line">                   cbData-&gt;glFormat, cbData-&gt;glType, pixels);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((cbData-&gt;glError = glGetError()) == GL_NO_ERROR) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_SUCCESS;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_GL_ERROR;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">compressedTexImage3DCallback(<span class="keywordtype">int</span> miplevel, <span class="keywordtype">int</span> face,</div>
<div class="line">                             <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,</div>
<div class="line">                             <span class="keywordtype">int</span> depth,</div>
<div class="line">                             ktx_uint64_t faceLodSize,</div>
<div class="line">                             <span class="keywordtype">void</span>* pixels, <span class="keywordtype">void</span>* userdata)</div>
<div class="line">{</div>
<div class="line">    ktx_cbdata* cbData = (ktx_cbdata*)userdata;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (faceLodSize &gt; UINT32_MAX)</div>
<div class="line">        <span class="keywordflow">return</span> KTX_INVALID_OPERATION; <span class="comment">// Too big for OpenGL {,ES}.</span></div>
<div class="line"> </div>
<div class="line">    assert(gl.glCompressedTexImage3D != NULL);</div>
<div class="line">    gl.glCompressedTexImage3D(cbData-&gt;glTarget + face, miplevel,</div>
<div class="line">                             cbData-&gt;glInternalformat,</div>
<div class="line">                             width, height,</div>
<div class="line">                             cbData-&gt;numLayers == 0 ? (GLuint)depth : cbData-&gt;numLayers,</div>
<div class="line">                             0,</div>
<div class="line">                             (ktx_uint32_t)faceLodSize, pixels);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((cbData-&gt;glError = glGetError()) == GL_NO_ERROR) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_SUCCESS;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_GL_ERROR;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>This function creates the GL texture object and sets up the callbacks to load the image data into it. </p><div class="fragment"><div class="line">KTX_error_code</div>
<div class="line">ktxTexture_GLUploadPrivate(<a class="code hl_class" href="structktxTexture.html">ktxTexture</a>* This, ktx_glformatinfo* formatInfo,</div>
<div class="line">                           GLuint* pTexture, GLenum* pTarget, GLenum* pGlerror)</div>
<div class="line">{</div>
<div class="line">    GLuint                texname;</div>
<div class="line">    GLenum                target = GL_TEXTURE_2D;</div>
<div class="line">    <span class="keywordtype">int</span>                   texnameUser;</div>
<div class="line">    KTX_error_code        result = KTX_SUCCESS;</div>
<div class="line">    ktx_cbdata            cbData;</div>
<div class="line">    PFNKTXITERCB          iterCb = NULL;</div>
<div class="line">    <span class="keywordtype">int</span>                   dimensions;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pGlerror)</div>
<div class="line">        *pGlerror = GL_NO_ERROR;</div>
<div class="line"> </div>
<div class="line">    assert(This &amp;&amp; pTarget);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (contextProfile == 0)</div>
<div class="line">        discoverContextCapabilities();</div>
<div class="line"> </div>
<div class="line">    texnameUser = pTexture &amp;&amp; *pTexture;</div>
<div class="line">    <span class="keywordflow">if</span> (texnameUser) {</div>
<div class="line">        texname = *pTexture;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        glGenTextures(1, &amp;texname);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    cbData.glFormat = formatInfo-&gt;glFormat;</div>
<div class="line">    cbData.glInternalformat = formatInfo-&gt;glInternalformat;</div>
<div class="line">    cbData.glType = formatInfo-&gt;glType;</div>
<div class="line"> </div>
<div class="line">    dimensions = This-&gt;<a class="code hl_variable" href="structktxTexture.html#ae4378ab23f88acb257e6b4c1d8f64bb8">numDimensions</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (This-&gt;<a class="code hl_variable" href="structktxTexture.html#ae904839d65da570a3b066a93e4573dab">isArray</a>) {</div>
<div class="line">        dimensions += 1;</div>
<div class="line">        <span class="keywordflow">if</span> (This-&gt;<a class="code hl_variable" href="structktxTexture.html#acc36239d64c8e0562a7a14ccd140af70">numFaces</a> == 6) {</div>
<div class="line">            <span class="comment">/* ktxCheckHeader1_ should have caught this. */</span></div>
<div class="line">            assert(This-&gt;<a class="code hl_variable" href="structktxTexture.html#ae4378ab23f88acb257e6b4c1d8f64bb8">numDimensions</a> == 2);</div>
<div class="line">            target = GL_TEXTURE_CUBE_MAP_ARRAY;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">switch</span> (This-&gt;<a class="code hl_variable" href="structktxTexture.html#ae4378ab23f88acb257e6b4c1d8f64bb8">numDimensions</a>) {</div>
<div class="line">              <span class="keywordflow">case</span> 1: target = GL_TEXTURE_1D_ARRAY; <span class="keywordflow">break</span>;</div>
<div class="line">              <span class="keywordflow">case</span> 2: target = GL_TEXTURE_2D_ARRAY; <span class="keywordflow">break</span>;</div>
<div class="line">              <span class="comment">/* _ktxCheckHeader should have caught this. */</span></div>
<div class="line">              <span class="keywordflow">default</span>: assert(KTX_TRUE);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        cbData.numLayers = This-&gt;numLayers;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (This-&gt;<a class="code hl_variable" href="structktxTexture.html#acc36239d64c8e0562a7a14ccd140af70">numFaces</a> == 6) {</div>
<div class="line">            <span class="comment">/* ktxCheckHeader1_ should have caught this. */</span></div>
<div class="line">            assert(This-&gt;<a class="code hl_variable" href="structktxTexture.html#ae4378ab23f88acb257e6b4c1d8f64bb8">numDimensions</a> == 2);</div>
<div class="line">            target = GL_TEXTURE_CUBE_MAP;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">switch</span> (This-&gt;<a class="code hl_variable" href="structktxTexture.html#ae4378ab23f88acb257e6b4c1d8f64bb8">numDimensions</a>) {</div>
<div class="line">              <span class="keywordflow">case</span> 1: target = GL_TEXTURE_1D; <span class="keywordflow">break</span>;</div>
<div class="line">              <span class="keywordflow">case</span> 2: target = GL_TEXTURE_2D; <span class="keywordflow">break</span>;</div>
<div class="line">              <span class="keywordflow">case</span> 3: target = GL_TEXTURE_3D; <span class="keywordflow">break</span>;</div>
<div class="line">              <span class="comment">/* _ktxCheckHeader shold have caught this. */</span></div>
<div class="line">              <span class="keywordflow">default</span>: assert(KTX_TRUE);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        cbData.numLayers = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (target == GL_TEXTURE_1D &amp;&amp;</div>
<div class="line">        ((This-&gt;isCompressed &amp;&amp; (gl.glCompressedTexImage1D == NULL)) ||</div>
<div class="line">         (!This-&gt;isCompressed &amp;&amp; (gl.glTexImage1D == NULL))))</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_UNSUPPORTED_TEXTURE_TYPE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Reject 3D texture if unsupported. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (target == GL_TEXTURE_3D &amp;&amp;</div>
<div class="line">        ((This-&gt;isCompressed &amp;&amp; (gl.glCompressedTexImage3D == NULL)) ||</div>
<div class="line">         (!This-&gt;isCompressed &amp;&amp; (gl.glTexImage3D == NULL))))</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_UNSUPPORTED_TEXTURE_TYPE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Reject cube map arrays if not supported. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (target == GL_TEXTURE_CUBE_MAP_ARRAY &amp;&amp; !supportsCubeMapArrays) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_UNSUPPORTED_TEXTURE_TYPE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* XXX Need to reject other array textures &amp; cube maps if not supported. */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (dimensions) {</div>
<div class="line">      <span class="keywordflow">case</span> 1:</div>
<div class="line">        iterCb = This-&gt;isCompressed</div>
<div class="line">                  ? compressedTexImage1DCallback : texImage1DCallback;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">case</span> 2:</div>
<div class="line">        iterCb = This-&gt;isCompressed</div>
<div class="line">                  ? compressedTexImage2DCallback : texImage2DCallback;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">case</span> 3:</div>
<div class="line">        iterCb = This-&gt;isCompressed</div>
<div class="line">                  ? compressedTexImage3DCallback : texImage3DCallback;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">default</span>:</div>
<div class="line">            assert(KTX_TRUE);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    glBindTexture(target, texname);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Prefer glGenerateMipmaps over GL_GENERATE_MIPMAP</span></div>
<div class="line">    <span class="keywordflow">if</span> (This-&gt;<a class="code hl_variable" href="structktxTexture.html#a4159f859437a820d7984beda366e2eaa">generateMipmaps</a> &amp;&amp; (gl.glGenerateMipmap == NULL)) {</div>
<div class="line">        glTexParameteri(target, GL_GENERATE_MIPMAP, GL_TRUE);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!This-&gt;<a class="code hl_variable" href="structktxTexture.html#a4159f859437a820d7984beda366e2eaa">generateMipmaps</a> &amp;&amp; supportsMaxLevel)</div>
<div class="line">        glTexParameteri(target, GL_TEXTURE_MAX_LEVEL, This-&gt;<a class="code hl_variable" href="structktxTexture.html#aad80dfe68bfa0c1ddcc127c4c6e1dda8">numLevels</a> - 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (target == GL_TEXTURE_CUBE_MAP) {</div>
<div class="line">        cbData.glTarget = GL_TEXTURE_CUBE_MAP_POSITIVE_X;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        cbData.glTarget = target;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!This-&gt;isCompressed) {</div>
<div class="line"><span class="preprocessor">#if SUPPORT_LEGACY_FORMAT_CONVERSION</span></div>
<div class="line">        <span class="comment">// If sized legacy formats are supported there is no need to convert.</span></div>
<div class="line">        <span class="comment">// If only unsized formats are supported, there is no point in</span></div>
<div class="line">        <span class="comment">// converting as the modern formats aren&#39;t supported either.</span></div>
<div class="line">        <span class="keywordflow">if</span> (sizedFormats == _NON_LEGACY_FORMATS &amp;&amp; supportsSwizzle) {</div>
<div class="line">            convertFormat(target, &amp;cbData.glFormat, &amp;cbData.glInternalformat);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sizedFormats == _NO_SIZED_FORMATS)</div>
<div class="line">            cbData.glInternalformat = formatInfo-&gt;glBaseInternalformat;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">        <span class="comment">// When no sized formats are supported, or legacy sized formats are not</span></div>
<div class="line">        <span class="comment">// supported, must change internal format.</span></div>
<div class="line">        <span class="keywordflow">if</span> (sizedFormats == _NO_SIZED_FORMATS</div>
<div class="line">            || (!(sizedFormats &amp; _LEGACY_FORMATS) &amp;&amp;</div>
<div class="line">                (formatInfo-&gt;glBaseInternalformat == GL_ALPHA</div>
<div class="line">                || formatInfo-&gt;glBaseInternalformat == GL_LUMINANCE</div>
<div class="line">                || formatInfo-&gt;glBaseInternalformat == GL_LUMINANCE_ALPHA</div>
<div class="line">                || formatInfo-&gt;glBaseInternalformat == GL_INTENSITY))) {</div>
<div class="line">            cbData.glInternalformat = formatInfo-&gt;glBaseInternalformat;</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ktxTexture_isActiveStream(<a class="code hl_class" href="structktxTexture.html">ktxTexture</a>(This)))</div>
<div class="line">        result = ktxTexture_IterateLoadLevelFaces(This, iterCb, &amp;cbData);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        result = ktxTexture_IterateLevelFaces(This, iterCb, &amp;cbData);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* GL errors are the only reason for failure. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (result != KTX_SUCCESS &amp;&amp; cbData.glError != GL_NO_ERROR) {</div>
<div class="line">        <span class="keywordflow">if</span> (pGlerror)</div>
<div class="line">            *pGlerror = cbData.glError;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (result == KTX_SUCCESS)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Prefer glGenerateMipmaps over GL_GENERATE_MIPMAP</span></div>
<div class="line">        <span class="keywordflow">if</span> (This-&gt;<a class="code hl_variable" href="structktxTexture.html#a4159f859437a820d7984beda366e2eaa">generateMipmaps</a> &amp;&amp; gl.glGenerateMipmap) {</div>
<div class="line">            gl.glGenerateMipmap(target);</div>
<div class="line">        }</div>
<div class="line">        *pTarget = target;</div>
<div class="line">        <span class="keywordflow">if</span> (pTexture) {</div>
<div class="line">            *pTexture = texname;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!texnameUser) {</div>
<div class="line">        glDeleteTextures(1, &amp;texname);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">/* -*- tab-width: 4; -*- */</span></div>
<div class="line"><span class="comment">/* vi: set sw=2 ts=4 expandtab: */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Copyright 2010-2020 Mark Callow.</span></div>
<div class="line"><span class="comment"> * SPDX-License-Identifier: Apache-2.0</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * @internal</span></div>
<div class="line"><span class="comment"> * @file</span></div>
<div class="line"><span class="comment"> * @~English</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * @brief Functions for instantiating GL or GLES textures from KTX files.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * @author Georg Kolling, Imagination Technology</span></div>
<div class="line"><span class="comment"> * @author Mark Callow, HI Corporation &amp; Edgewise Consulting</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><span class="preprocessor">#define _CRT_SECURE_NO_WARNINGS</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;gl_funcs.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;ktx.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ktxint.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;texture.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;vk2gl.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;unused.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * These are defined only in compatibility mode (gl.h) not glcorearb.h</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="preprocessor">#if !defined( GL_LUMINANCE )</span></div>
<div class="line"><span class="preprocessor">#define GL_LUMINANCE                  0x1909    </span><span class="comment">// deprecated</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">#if !defined( GL_LUMINANCE_ALPHA )</span></div>
<div class="line"><span class="preprocessor">#define GL_LUMINANCE_ALPHA            0x190A    </span><span class="comment">// deprecated</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">#if !defined( GL_INTENSITY )</span></div>
<div class="line"><span class="preprocessor">#define GL_INTENSITY                  0x8049    </span><span class="comment">// deprecated</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * N.B. As of Doxygen 1.9.6 non-class members must use fully qualified</span></div>
<div class="line"><span class="comment"> * names with @ref and @copy* references to classes. This means prefixing</span></div>
<div class="line"><span class="comment"> * a reference with the name of the (pseudo-)class of which it is a member.</span></div>
<div class="line"><span class="comment"> * We use @memberof to improve the index and toc for the doc for our</span></div>
<div class="line"><span class="comment"> * pseudo classes so we need to prefix. Since we don&#39;t want, e.g.,</span></div>
<div class="line"><span class="comment"> * ktxTexture1::ktxTexture1_GLUpload appearing in the documentation we have</span></div>
<div class="line"><span class="comment"> * to explicitly provide the link text making references very long-winded.</span></div>
<div class="line"><span class="comment"> * Sigh!</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define GL_GENERATE_MIPMAP              0x8191</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define _CONTEXT_ES_PROFILE_BIT 0x4</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define _NON_LEGACY_FORMATS 0x1 </span><span class="comment">/*&lt; @internal Non-legacy sized formats are supported. */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define _LEGACY_FORMATS 0x2  </span><span class="comment">/*&lt; @internal Legacy sized formats are supported. */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define _ALL_SIZED_FORMATS (_NON_LEGACY_FORMATS | _LEGACY_FORMATS)</span></div>
<div class="line"><span class="preprocessor">#define _NO_SIZED_FORMATS 0 </span><span class="comment">/*&lt; @internal No sized formats are supported. */</span><span class="preprocessor"></span></div>
<div class="line"><span class="keyword">static</span> GLint contextProfile = 0;</div>
<div class="line"><span class="keyword">static</span> GLint sizedFormats = _ALL_SIZED_FORMATS;</div>
<div class="line"><span class="keyword">static</span> GLboolean supportsSwizzle = GL_TRUE;</div>
<div class="line"><span class="keyword">static</span> GLint R16Formats = _KTX_ALL_R16_FORMATS;</div>
<div class="line"><span class="keyword">static</span> GLboolean supportsSRGB = GL_TRUE;</div>
<div class="line"><span class="keyword">static</span> GLboolean supportsCubeMapArrays = GL_FALSE;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> GLboolean supportsMaxLevel = GL_FALSE;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> GLboolean</div>
<div class="line">hasExtension(<span class="keyword">const</span> <span class="keywordtype">char</span>* extension)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (gl.glGetStringi == NULL) {</div>
<div class="line">        <span class="keywordflow">if</span> (strstr(glGetString(GL_EXTENSIONS), extension) != NULL) {</div>
<div class="line">            <span class="keywordflow">return</span> GL_TRUE;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">return</span> GL_FALSE;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordtype">int</span> i, n;</div>
<div class="line"> </div>
<div class="line">        glGetIntegerv(GL_NUM_EXTENSIONS, &amp;n);</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {</div>
<div class="line">            <span class="keywordflow">if</span> (strcmp((<span class="keyword">const</span> <span class="keywordtype">char</span>*)gl.glGetStringi(GL_EXTENSIONS, i), extension) == 0)</div>
<div class="line">                <span class="keywordflow">return</span> GL_TRUE;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> GL_FALSE;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">discoverContextCapabilities(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    GLint majorVersion = 1;</div>
<div class="line">    GLint minorVersion = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strstr(glGetString(GL_VERSION), <span class="stringliteral">&quot;GL ES&quot;</span>) != NULL)</div>
<div class="line">        contextProfile = _CONTEXT_ES_PROFILE_BIT;</div>
<div class="line">    <span class="comment">// MAJOR &amp; MINOR only introduced in GL {,ES} 3.0</span></div>
<div class="line">    glGetIntegerv(GL_MAJOR_VERSION, &amp;majorVersion);</div>
<div class="line">    glGetIntegerv(GL_MINOR_VERSION, &amp;minorVersion);</div>
<div class="line">    <span class="keywordflow">if</span> (glGetError() != GL_NO_ERROR) {</div>
<div class="line">        <span class="comment">// &lt; v3.0; resort to the old-fashioned way.</span></div>
<div class="line">        <span class="keywordflow">if</span> (contextProfile &amp; _CONTEXT_ES_PROFILE_BIT)</div>
<div class="line">            sscanf(glGetString(GL_VERSION), <span class="stringliteral">&quot;OpenGL ES %d.%d &quot;</span>,</div>
<div class="line">                   &amp;majorVersion, &amp;minorVersion);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            sscanf(glGetString(GL_VERSION), <span class="stringliteral">&quot;OpenGL %d.%d &quot;</span>,</div>
<div class="line">                   &amp;majorVersion, &amp;minorVersion);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (contextProfile &amp; _CONTEXT_ES_PROFILE_BIT) {</div>
<div class="line">        <span class="keywordflow">if</span> (majorVersion &lt; 3) {</div>
<div class="line">            supportsSwizzle = GL_FALSE;</div>
<div class="line">            sizedFormats = _NO_SIZED_FORMATS;</div>
<div class="line">            R16Formats = _KTX_NO_R16_FORMATS;</div>
<div class="line">            supportsSRGB = GL_FALSE;</div>
<div class="line">            <span class="comment">// These things could be found by dlsym when, e.g. the same driver</span></div>
<div class="line">            <span class="comment">// supports ES1, ES2 and ES3. For all but Tex*3D, there&#39;s no</span></div>
<div class="line">            <span class="comment">// corresponding extension whose presence we could check. Just zero</span></div>
<div class="line">            <span class="comment">// the pointers to prevent use.</span></div>
<div class="line">            gl.glGetStringi = NULL;</div>
<div class="line">            gl.glCompressedTexImage1D = NULL;</div>
<div class="line">            gl.glTexStorage1D = NULL;</div>
<div class="line">            gl.glTexStorage2D = NULL;</div>
<div class="line">            gl.glTexStorage3D = NULL;</div>
<div class="line">            <span class="keywordflow">if</span> (!hasExtension(<span class="stringliteral">&quot;GL_OES_texture_3D&quot;</span>)) {</div>
<div class="line">                gl.glCompressedTexImage3D = NULL;</div>
<div class="line">                gl.glCompressedTexSubImage3D = NULL;</div>
<div class="line">                gl.glTexImage3D = NULL;</div>
<div class="line">                gl.glTexSubImage3D = NULL;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (majorVersion &lt; 2)</div>
<div class="line">                gl.glGenerateMipmap = NULL;</div>
<div class="line"> </div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            sizedFormats = _NON_LEGACY_FORMATS;</div>
<div class="line">            <span class="keywordflow">if</span> (hasExtension(<span class="stringliteral">&quot;GL_EXT_texture_cube_map_array&quot;</span>)) {</div>
<div class="line">                supportsCubeMapArrays = GL_TRUE;</div>
<div class="line">            }</div>
<div class="line">            supportsMaxLevel = GL_TRUE;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (hasExtension(<span class="stringliteral">&quot;GL_OES_required_internalformat&quot;</span>)) {</div>
<div class="line">            sizedFormats |= _ALL_SIZED_FORMATS;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">// There are no OES extensions for sRGB textures or R16 formats.</span></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="comment">// PROFILE_MASK was introduced in OpenGL 3.2.</span></div>
<div class="line">        <span class="comment">// Profiles: CONTEXT_CORE_PROFILE_BIT 0x1,</span></div>
<div class="line">        <span class="comment">//           CONTEXT_COMPATIBILITY_PROFILE_BIT 0x2.</span></div>
<div class="line">        glGetIntegerv(GL_CONTEXT_PROFILE_MASK, &amp;contextProfile);</div>
<div class="line">        <span class="keywordflow">if</span> (glGetError() == GL_NO_ERROR) {</div>
<div class="line">            <span class="comment">// &gt;= 3.2</span></div>
<div class="line">            <span class="keywordflow">if</span> (majorVersion == 3 &amp;&amp; minorVersion &lt; 3)</div>
<div class="line">                supportsSwizzle = GL_FALSE;</div>
<div class="line">            <span class="keywordflow">if</span> ((contextProfile &amp; GL_CONTEXT_CORE_PROFILE_BIT))</div>
<div class="line">                sizedFormats &amp;= ~_LEGACY_FORMATS;</div>
<div class="line">            <span class="keywordflow">if</span> (majorVersion &gt;= 4)</div>
<div class="line">                supportsCubeMapArrays = GL_TRUE;</div>
<div class="line">            supportsMaxLevel = GL_TRUE;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="comment">// &lt; 3.2</span></div>
<div class="line">            contextProfile = GL_CONTEXT_COMPATIBILITY_PROFILE_BIT;</div>
<div class="line">            supportsSwizzle = GL_FALSE;</div>
<div class="line">            <span class="comment">// sRGB textures introduced in 2.0</span></div>
<div class="line">            <span class="keywordflow">if</span> (majorVersion &lt; 2 &amp;&amp; !hasExtension(<span class="stringliteral">&quot;GL_EXT_texture_sRGB&quot;</span>)) {</div>
<div class="line">                supportsSRGB = GL_FALSE;</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">// R{,G]16 introduced in 3.0; R{,G}16_SNORM introduced in 3.1.</span></div>
<div class="line">            <span class="keywordflow">if</span> (majorVersion == 3) {</div>
<div class="line">                <span class="keywordflow">if</span> (minorVersion == 0)</div>
<div class="line">                    R16Formats &amp;= ~_KTX_R16_FORMATS_SNORM;</div>
<div class="line">                <span class="keywordflow">if</span> (minorVersion &lt; 1) {</div>
<div class="line">                    <span class="keywordflow">if</span> (hasExtension(<span class="stringliteral">&quot;GL_ARB_texture_query_levels&quot;</span>))</div>
<div class="line">                        supportsMaxLevel = GL_TRUE;</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                  supportsMaxLevel = GL_TRUE;</div>
<div class="line">                }</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hasExtension(<span class="stringliteral">&quot;GL_ARB_texture_rg&quot;</span>)) {</div>
<div class="line">                R16Formats &amp;= ~_KTX_R16_FORMATS_SNORM;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                R16Formats = _KTX_NO_R16_FORMATS;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (!supportsCubeMapArrays) {</div>
<div class="line">            <span class="keywordflow">if</span> (hasExtension(<span class="stringliteral">&quot;GL_ARB_texture_cube_map_array&quot;</span>)) {</div>
<div class="line">                supportsCubeMapArrays = GL_TRUE;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if SUPPORT_LEGACY_FORMAT_CONVERSION</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> convertFormat(GLenum target, GLenum* pFormat, GLenum* pInternalformat) {</div>
<div class="line">    <span class="keywordflow">switch</span> (*pFormat) {</div>
<div class="line">      <span class="keywordflow">case</span> GL_ALPHA:</div>
<div class="line">        {</div>
<div class="line">          GLint swizzle[] = {GL_ZERO, GL_ZERO, GL_ZERO, GL_RED};</div>
<div class="line">          *pFormat = GL_RED;</div>
<div class="line">          glTexParameteriv(target, GL_TEXTURE_SWIZZLE_RGBA, swizzle);</div>
<div class="line">          <span class="keywordflow">switch</span> (*pInternalformat) {</div>
<div class="line">            <span class="keywordflow">case</span> GL_ALPHA:</div>
<div class="line">            <span class="keywordflow">case</span> GL_ALPHA4:</div>
<div class="line">            <span class="keywordflow">case</span> GL_ALPHA8:</div>
<div class="line">              *pInternalformat = GL_R8;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> GL_ALPHA12:</div>
<div class="line">            <span class="keywordflow">case</span> GL_ALPHA16:</div>
<div class="line">              *pInternalformat = GL_R16;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      <span class="keywordflow">case</span> GL_LUMINANCE:</div>
<div class="line">        {</div>
<div class="line">          GLint swizzle[] = {GL_RED, GL_RED, GL_RED, GL_ONE};</div>
<div class="line">          *pFormat = GL_RED;</div>
<div class="line">          glTexParameteriv(target, GL_TEXTURE_SWIZZLE_RGBA, swizzle);</div>
<div class="line">          <span class="keywordflow">switch</span> (*pInternalformat) {</div>
<div class="line">            <span class="keywordflow">case</span> GL_LUMINANCE:</div>
<div class="line">            <span class="keywordflow">case</span> GL_LUMINANCE4:</div>
<div class="line">            <span class="keywordflow">case</span> GL_LUMINANCE8:</div>
<div class="line">              *pInternalformat = GL_R8;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> GL_LUMINANCE12:</div>
<div class="line">            <span class="keywordflow">case</span> GL_LUMINANCE16:</div>
<div class="line">              *pInternalformat = GL_R16;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="preprocessor">#if 0</span></div>
<div class="line">            <span class="comment">// XXX Must avoid setting TEXTURE_SWIZZLE in these cases</span></div>
<div class="line">            <span class="comment">// XXX Must manually swizzle.</span></div>
<div class="line">            <span class="keywordflow">case</span> GL_SLUMINANCE:</div>
<div class="line">            <span class="keywordflow">case</span> GL_SLUMINANCE8:</div>
<div class="line">              *pInternalformat = GL_SRGB8;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">      <span class="keywordflow">case</span> GL_LUMINANCE_ALPHA:</div>
<div class="line">        {</div>
<div class="line">          GLint swizzle[] = {GL_RED, GL_RED, GL_RED, GL_GREEN};</div>
<div class="line">          *pFormat = GL_RG;</div>
<div class="line">          glTexParameteriv(target, GL_TEXTURE_SWIZZLE_RGBA, swizzle);</div>
<div class="line">          <span class="keywordflow">switch</span> (*pInternalformat) {</div>
<div class="line">            <span class="keywordflow">case</span> GL_LUMINANCE_ALPHA:</div>
<div class="line">            <span class="keywordflow">case</span> GL_LUMINANCE4_ALPHA4:</div>
<div class="line">            <span class="keywordflow">case</span> GL_LUMINANCE6_ALPHA2:</div>
<div class="line">            <span class="keywordflow">case</span> GL_LUMINANCE8_ALPHA8:</div>
<div class="line">              *pInternalformat = GL_RG8;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> GL_LUMINANCE12_ALPHA4:</div>
<div class="line">            <span class="keywordflow">case</span> GL_LUMINANCE12_ALPHA12:</div>
<div class="line">            <span class="keywordflow">case</span> GL_LUMINANCE16_ALPHA16:</div>
<div class="line">              *pInternalformat = GL_RG16;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="preprocessor">#if 0</span></div>
<div class="line">            <span class="comment">// XXX Must avoid setting TEXTURE_SWIZZLE in these cases</span></div>
<div class="line">            <span class="comment">// XXX Must manually swizzle.</span></div>
<div class="line">            <span class="keywordflow">case</span> GL_SLUMINANCE_ALPHA:</div>
<div class="line">            <span class="keywordflow">case</span> GL_SLUMINANCE8_ALPHA8:</div>
<div class="line">              *pInternalformat = GL_SRGB8_ALPHA8;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">      <span class="keywordflow">case</span> GL_INTENSITY:</div>
<div class="line">        {</div>
<div class="line">          GLint swizzle[] = {GL_RED, GL_RED, GL_RED, GL_RED};</div>
<div class="line">          *pFormat = GL_RED;</div>
<div class="line">          glTexParameteriv(target, GL_TEXTURE_SWIZZLE_RGBA, swizzle);</div>
<div class="line">          <span class="keywordflow">switch</span> (*pInternalformat) {</div>
<div class="line">            <span class="keywordflow">case</span> GL_INTENSITY:</div>
<div class="line">            <span class="keywordflow">case</span> GL_INTENSITY4:</div>
<div class="line">            <span class="keywordflow">case</span> GL_INTENSITY8:</div>
<div class="line">              *pInternalformat = GL_R8;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            <span class="keywordflow">case</span> GL_INTENSITY12:</div>
<div class="line">            <span class="keywordflow">case</span> GL_INTENSITY16:</div>
<div class="line">              *pInternalformat = GL_R16;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">      <span class="keywordflow">default</span>:</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* SUPPORT_LEGACY_FORMAT_CONVERSION */</span><span class="preprocessor"></span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>ktx_glformatinfo {</div>
<div class="line">   ktx_uint32_t glFormat;</div>
<div class="line">   ktx_uint32_t glInternalformat;</div>
<div class="line">   ktx_uint32_t glBaseInternalformat;</div>
<div class="line">   ktx_uint32_t glType;</div>
<div class="line">} ktx_glformatinfo;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* [cbdata] */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>ktx_cbdata {</div>
<div class="line">    GLenum glTarget;</div>
<div class="line">    GLenum glFormat;</div>
<div class="line">    GLenum glInternalformat;</div>
<div class="line">    GLenum glType;</div>
<div class="line">    GLenum glError;</div>
<div class="line">    GLuint numLayers;</div>
<div class="line">} ktx_cbdata;</div>
<div class="line"><span class="comment">/* [cbdata] */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* [imageCallbacks] */</span></div>
<div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">texImage1DCallback(<span class="keywordtype">int</span> miplevel, <span class="keywordtype">int</span> face,</div>
<div class="line">                   <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,</div>
<div class="line">                   <span class="keywordtype">int</span> depth,</div>
<div class="line">                   ktx_uint64_t faceLodSize,</div>
<div class="line">                   <span class="keywordtype">void</span>* pixels, <span class="keywordtype">void</span>* userdata)</div>
<div class="line">{</div>
<div class="line">    ktx_cbdata* cbData = (ktx_cbdata*)userdata;</div>
<div class="line">    UNUSED(faceLodSize);</div>
<div class="line">    UNUSED(depth);</div>
<div class="line">    UNUSED(height);</div>
<div class="line"> </div>
<div class="line">    assert(gl.glTexImage1D != NULL);</div>
<div class="line">    gl.glTexImage1D(cbData-&gt;<a id="a0" name="a0"></a>glTarget + face, miplevel,</div>
<div class="line">                   cbData-&gt;<a id="a1" name="a1"></a>glInternalformat, width, 0,</div>
<div class="line">                   cbData-&gt;<a id="a2" name="a2"></a>glFormat, cbData-&gt;<a id="a3" name="a3"></a>glType, pixels);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((cbData-&gt;<a id="a4" name="a4"></a>glError = glGetError()) == GL_NO_ERROR) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_SUCCESS;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_GL_ERROR;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">compressedTexImage1DCallback(<span class="keywordtype">int</span> miplevel, <span class="keywordtype">int</span> face,</div>
<div class="line">                             <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,</div>
<div class="line">                             <span class="keywordtype">int</span> depth,</div>
<div class="line">                             ktx_uint64_t faceLodSize,</div>
<div class="line">                             <span class="keywordtype">void</span>* pixels, <span class="keywordtype">void</span>* userdata)</div>
<div class="line">{</div>
<div class="line">    ktx_cbdata* cbData = (ktx_cbdata*)userdata;</div>
<div class="line">    UNUSED(depth);</div>
<div class="line">    UNUSED(height);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (faceLodSize &gt; UINT32_MAX)</div>
<div class="line">        <span class="keywordflow">return</span> KTX_INVALID_OPERATION; <span class="comment">// Too big for OpenGL {,ES}.</span></div>
<div class="line"> </div>
<div class="line">    assert(gl.glCompressedTexImage1D != NULL);</div>
<div class="line">    gl.glCompressedTexImage1D(cbData-&gt;glTarget + face, miplevel,</div>
<div class="line">                             cbData-&gt;glInternalformat, width, 0,</div>
<div class="line">                             (ktx_uint32_t)faceLodSize, pixels);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((cbData-&gt;glError = glGetError()) == GL_NO_ERROR) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_SUCCESS;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_GL_ERROR;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">texImage2DCallback(<span class="keywordtype">int</span> miplevel, <span class="keywordtype">int</span> face,</div>
<div class="line">                   <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,</div>
<div class="line">                   <span class="keywordtype">int</span> depth,</div>
<div class="line">                   ktx_uint64_t faceLodSize,</div>
<div class="line">                   <span class="keywordtype">void</span>* pixels, <span class="keywordtype">void</span>* userdata)</div>
<div class="line">{</div>
<div class="line">    ktx_cbdata* cbData = (ktx_cbdata*)userdata;</div>
<div class="line">    UNUSED(depth);</div>
<div class="line">    UNUSED(faceLodSize);</div>
<div class="line"> </div>
<div class="line">    glTexImage2D(cbData-&gt;glTarget + face, miplevel,</div>
<div class="line">                 cbData-&gt;glInternalformat, width,</div>
<div class="line">                 cbData-&gt;<a id="a5" name="a5"></a>numLayers == 0 ? (GLuint)height : cbData-&gt;numLayers, 0,</div>
<div class="line">                 cbData-&gt;glFormat, cbData-&gt;glType, pixels);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((cbData-&gt;glError = glGetError()) == GL_NO_ERROR) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_SUCCESS;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_GL_ERROR;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">compressedTexImage2DCallback(<span class="keywordtype">int</span> miplevel, <span class="keywordtype">int</span> face,</div>
<div class="line">                             <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,</div>
<div class="line">                             <span class="keywordtype">int</span> depth,</div>
<div class="line">                             ktx_uint64_t faceLodSize,</div>
<div class="line">                             <span class="keywordtype">void</span>* pixels, <span class="keywordtype">void</span>* userdata)</div>
<div class="line">{</div>
<div class="line">    ktx_cbdata* cbData = (ktx_cbdata*)userdata;</div>
<div class="line">    GLenum glerror;</div>
<div class="line">    KTX_error_code result;</div>
<div class="line">    UNUSED(depth);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (faceLodSize &gt; UINT32_MAX)</div>
<div class="line">        <span class="keywordflow">return</span> KTX_INVALID_OPERATION; <span class="comment">// Too big for OpenGL {,ES}.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// It is simpler to just attempt to load the format, rather than divine</span></div>
<div class="line">    <span class="comment">// which formats are supported by the implementation. In the event of an</span></div>
<div class="line">    <span class="comment">// error, software unpacking can be attempted.</span></div>
<div class="line">    glCompressedTexImage2D(cbData-&gt;glTarget + face, miplevel,</div>
<div class="line">                           cbData-&gt;glInternalformat, width,</div>
<div class="line">                           cbData-&gt;numLayers == 0 ? (GLuint)height : cbData-&gt;numLayers,</div>
<div class="line">                           0,</div>
<div class="line">                           (ktx_uint32_t)faceLodSize, pixels);</div>
<div class="line"> </div>
<div class="line">    glerror = glGetError();</div>
<div class="line"><span class="preprocessor">#if SUPPORT_SOFTWARE_ETC_UNPACK</span></div>
<div class="line">    <span class="comment">// Renderion is returning INVALID_VALUE. Oops!!</span></div>
<div class="line">    <span class="keywordflow">if</span> ((glerror == GL_INVALID_ENUM || glerror == GL_INVALID_VALUE)</div>
<div class="line">        &amp;&amp; (cbData-&gt;glInternalformat == GL_ETC1_RGB8_OES</div>
<div class="line">            || (cbData-&gt;glInternalformat &gt;= GL_COMPRESSED_R11_EAC</div>
<div class="line">                &amp;&amp; cbData-&gt;glInternalformat &lt;= GL_COMPRESSED_SRGB8_ALPHA8_ETC2_EAC)</div>
<div class="line">            ))</div>
<div class="line">    {</div>
<div class="line">        GLubyte* unpacked;</div>
<div class="line">        GLenum format, internalformat, type;</div>
<div class="line"> </div>
<div class="line">        result = _ktxUnpackETC((GLubyte*)pixels, cbData-&gt;glInternalformat,</div>
<div class="line">                                  width, height, &amp;unpacked,</div>
<div class="line">                                  &amp;format, &amp;internalformat,</div>
<div class="line">                                  &amp;type, R16Formats, supportsSRGB);</div>
<div class="line">        <span class="keywordflow">if</span> (result != KTX_SUCCESS) {</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (!(sizedFormats &amp; _NON_LEGACY_FORMATS)) {</div>
<div class="line">            <span class="keywordflow">if</span> (internalformat == GL_RGB8)</div>
<div class="line">                internalformat = GL_RGB;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (internalformat == GL_RGBA8)</div>
<div class="line">                internalformat = GL_RGBA;</div>
<div class="line">        }</div>
<div class="line">        glTexImage2D(cbData-&gt;glTarget + face, miplevel,</div>
<div class="line">                     internalformat, width,</div>
<div class="line">                     cbData-&gt;numLayers == 0 ? (GLuint)height : cbData-&gt;numLayers, 0,</div>
<div class="line">                     format, type, unpacked);</div>
<div class="line"> </div>
<div class="line">        free(unpacked);</div>
<div class="line">        glerror = glGetError();</div>
<div class="line">    }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((cbData-&gt;glError = glerror) == GL_NO_ERROR) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_SUCCESS;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_GL_ERROR;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">texImage3DCallback(<span class="keywordtype">int</span> miplevel, <span class="keywordtype">int</span> face,</div>
<div class="line">                   <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,</div>
<div class="line">                   <span class="keywordtype">int</span> depth,</div>
<div class="line">                   ktx_uint64_t faceLodSize,</div>
<div class="line">                   <span class="keywordtype">void</span>* pixels, <span class="keywordtype">void</span>* userdata)</div>
<div class="line">{</div>
<div class="line">    ktx_cbdata* cbData = (ktx_cbdata*)userdata;</div>
<div class="line">    UNUSED(faceLodSize);</div>
<div class="line"> </div>
<div class="line">    assert(gl.glTexImage3D != NULL);</div>
<div class="line">    gl.glTexImage3D(cbData-&gt;glTarget + face, miplevel,</div>
<div class="line">                   cbData-&gt;glInternalformat,</div>
<div class="line">                   width, height,</div>
<div class="line">                   cbData-&gt;numLayers == 0 ? (GLuint)depth : cbData-&gt;numLayers,</div>
<div class="line">                   0,</div>
<div class="line">                   cbData-&gt;glFormat, cbData-&gt;glType, pixels);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((cbData-&gt;glError = glGetError()) == GL_NO_ERROR) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_SUCCESS;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_GL_ERROR;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">compressedTexImage3DCallback(<span class="keywordtype">int</span> miplevel, <span class="keywordtype">int</span> face,</div>
<div class="line">                             <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height,</div>
<div class="line">                             <span class="keywordtype">int</span> depth,</div>
<div class="line">                             ktx_uint64_t faceLodSize,</div>
<div class="line">                             <span class="keywordtype">void</span>* pixels, <span class="keywordtype">void</span>* userdata)</div>
<div class="line">{</div>
<div class="line">    ktx_cbdata* cbData = (ktx_cbdata*)userdata;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (faceLodSize &gt; UINT32_MAX)</div>
<div class="line">        <span class="keywordflow">return</span> KTX_INVALID_OPERATION; <span class="comment">// Too big for OpenGL {,ES}.</span></div>
<div class="line"> </div>
<div class="line">    assert(gl.glCompressedTexImage3D != NULL);</div>
<div class="line">    gl.glCompressedTexImage3D(cbData-&gt;glTarget + face, miplevel,</div>
<div class="line">                             cbData-&gt;glInternalformat,</div>
<div class="line">                             width, height,</div>
<div class="line">                             cbData-&gt;numLayers == 0 ? (GLuint)depth : cbData-&gt;numLayers,</div>
<div class="line">                             0,</div>
<div class="line">                             (ktx_uint32_t)faceLodSize, pixels);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((cbData-&gt;glError = glGetError()) == GL_NO_ERROR) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_SUCCESS;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_GL_ERROR;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="comment">/* [imageCallbacks] */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* [loadGLTexture] */</span></div>
<div class="line">KTX_error_code</div>
<div class="line">ktxTexture_GLUploadPrivate(<a id="_a6" name="_a6"></a><a class="code hl_class" href="structktxTexture.html">ktxTexture</a>* This, ktx_glformatinfo* formatInfo,</div>
<div class="line">                           GLuint* pTexture, GLenum* pTarget, GLenum* pGlerror)</div>
<div class="line">{</div>
<div class="line">    GLuint                texname;</div>
<div class="line">    GLenum                target = GL_TEXTURE_2D;</div>
<div class="line">    <span class="keywordtype">int</span>                   texnameUser;</div>
<div class="line">    KTX_error_code        result = KTX_SUCCESS;</div>
<div class="line">    ktx_cbdata            cbData;</div>
<div class="line">    PFNKTXITERCB          iterCb = NULL;</div>
<div class="line">    <span class="keywordtype">int</span>                   dimensions;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (pGlerror)</div>
<div class="line">        *pGlerror = GL_NO_ERROR;</div>
<div class="line"> </div>
<div class="line">    assert(This &amp;&amp; pTarget);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (contextProfile == 0)</div>
<div class="line">        discoverContextCapabilities();</div>
<div class="line"> </div>
<div class="line">    texnameUser = pTexture &amp;&amp; *pTexture;</div>
<div class="line">    <span class="keywordflow">if</span> (texnameUser) {</div>
<div class="line">        texname = *pTexture;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        glGenTextures(1, &amp;texname);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    cbData.glFormat = formatInfo-&gt;<a id="a7" name="a7"></a>glFormat;</div>
<div class="line">    cbData.glInternalformat = formatInfo-&gt;<a id="a8" name="a8"></a>glInternalformat;</div>
<div class="line">    cbData.glType = formatInfo-&gt;<a id="a9" name="a9"></a>glType;</div>
<div class="line"> </div>
<div class="line">    dimensions = This-&gt;<a id="a10" name="a10"></a><a class="code hl_variable" href="structktxTexture.html#ae4378ab23f88acb257e6b4c1d8f64bb8">numDimensions</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (This-&gt;<a id="a11" name="a11"></a><a class="code hl_variable" href="structktxTexture.html#ae904839d65da570a3b066a93e4573dab">isArray</a>) {</div>
<div class="line">        dimensions += 1;</div>
<div class="line">        <span class="keywordflow">if</span> (This-&gt;<a id="a12" name="a12"></a><a class="code hl_variable" href="structktxTexture.html#acc36239d64c8e0562a7a14ccd140af70">numFaces</a> == 6) {</div>
<div class="line">            <span class="comment">/* ktxCheckHeader1_ should have caught this. */</span></div>
<div class="line">            assert(This-&gt;<a class="code hl_variable" href="structktxTexture.html#ae4378ab23f88acb257e6b4c1d8f64bb8">numDimensions</a> == 2);</div>
<div class="line">            target = GL_TEXTURE_CUBE_MAP_ARRAY;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">switch</span> (This-&gt;<a class="code hl_variable" href="structktxTexture.html#ae4378ab23f88acb257e6b4c1d8f64bb8">numDimensions</a>) {</div>
<div class="line">              <span class="keywordflow">case</span> 1: target = GL_TEXTURE_1D_ARRAY; <span class="keywordflow">break</span>;</div>
<div class="line">              <span class="keywordflow">case</span> 2: target = GL_TEXTURE_2D_ARRAY; <span class="keywordflow">break</span>;</div>
<div class="line">              <span class="comment">/* _ktxCheckHeader should have caught this. */</span></div>
<div class="line">              <span class="keywordflow">default</span>: assert(KTX_TRUE);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        cbData.numLayers = This-&gt;<a id="a13" name="a13"></a>numLayers;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (This-&gt;<a class="code hl_variable" href="structktxTexture.html#acc36239d64c8e0562a7a14ccd140af70">numFaces</a> == 6) {</div>
<div class="line">            <span class="comment">/* ktxCheckHeader1_ should have caught this. */</span></div>
<div class="line">            assert(This-&gt;<a class="code hl_variable" href="structktxTexture.html#ae4378ab23f88acb257e6b4c1d8f64bb8">numDimensions</a> == 2);</div>
<div class="line">            target = GL_TEXTURE_CUBE_MAP;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">switch</span> (This-&gt;<a class="code hl_variable" href="structktxTexture.html#ae4378ab23f88acb257e6b4c1d8f64bb8">numDimensions</a>) {</div>
<div class="line">              <span class="keywordflow">case</span> 1: target = GL_TEXTURE_1D; <span class="keywordflow">break</span>;</div>
<div class="line">              <span class="keywordflow">case</span> 2: target = GL_TEXTURE_2D; <span class="keywordflow">break</span>;</div>
<div class="line">              <span class="keywordflow">case</span> 3: target = GL_TEXTURE_3D; <span class="keywordflow">break</span>;</div>
<div class="line">              <span class="comment">/* _ktxCheckHeader shold have caught this. */</span></div>
<div class="line">              <span class="keywordflow">default</span>: assert(KTX_TRUE);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        cbData.numLayers = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (target == GL_TEXTURE_1D &amp;&amp;</div>
<div class="line">        ((This-&gt;<a id="a14" name="a14"></a>isCompressed &amp;&amp; (gl.glCompressedTexImage1D == NULL)) ||</div>
<div class="line">         (!This-&gt;isCompressed &amp;&amp; (gl.glTexImage1D == NULL))))</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_UNSUPPORTED_TEXTURE_TYPE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Reject 3D texture if unsupported. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (target == GL_TEXTURE_3D &amp;&amp;</div>
<div class="line">        ((This-&gt;isCompressed &amp;&amp; (gl.glCompressedTexImage3D == NULL)) ||</div>
<div class="line">         (!This-&gt;isCompressed &amp;&amp; (gl.glTexImage3D == NULL))))</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_UNSUPPORTED_TEXTURE_TYPE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Reject cube map arrays if not supported. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (target == GL_TEXTURE_CUBE_MAP_ARRAY &amp;&amp; !supportsCubeMapArrays) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_UNSUPPORTED_TEXTURE_TYPE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* XXX Need to reject other array textures &amp; cube maps if not supported. */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (dimensions) {</div>
<div class="line">      <span class="keywordflow">case</span> 1:</div>
<div class="line">        iterCb = This-&gt;isCompressed</div>
<div class="line">                  ? compressedTexImage1DCallback : texImage1DCallback;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">case</span> 2:</div>
<div class="line">        iterCb = This-&gt;isCompressed</div>
<div class="line">                  ? compressedTexImage2DCallback : texImage2DCallback;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">case</span> 3:</div>
<div class="line">        iterCb = This-&gt;isCompressed</div>
<div class="line">                  ? compressedTexImage3DCallback : texImage3DCallback;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">default</span>:</div>
<div class="line">            assert(KTX_TRUE);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    glBindTexture(target, texname);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Prefer glGenerateMipmaps over GL_GENERATE_MIPMAP</span></div>
<div class="line">    <span class="keywordflow">if</span> (This-&gt;<a id="a15" name="a15"></a><a class="code hl_variable" href="structktxTexture.html#a4159f859437a820d7984beda366e2eaa">generateMipmaps</a> &amp;&amp; (gl.glGenerateMipmap == NULL)) {</div>
<div class="line">        glTexParameteri(target, GL_GENERATE_MIPMAP, GL_TRUE);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!This-&gt;<a class="code hl_variable" href="structktxTexture.html#a4159f859437a820d7984beda366e2eaa">generateMipmaps</a> &amp;&amp; supportsMaxLevel)</div>
<div class="line">        glTexParameteri(target, GL_TEXTURE_MAX_LEVEL, This-&gt;<a id="a16" name="a16"></a><a class="code hl_variable" href="structktxTexture.html#aad80dfe68bfa0c1ddcc127c4c6e1dda8">numLevels</a> - 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (target == GL_TEXTURE_CUBE_MAP) {</div>
<div class="line">        cbData.glTarget = GL_TEXTURE_CUBE_MAP_POSITIVE_X;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        cbData.glTarget = target;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!This-&gt;isCompressed) {</div>
<div class="line"><span class="preprocessor">#if SUPPORT_LEGACY_FORMAT_CONVERSION</span></div>
<div class="line">        <span class="comment">// If sized legacy formats are supported there is no need to convert.</span></div>
<div class="line">        <span class="comment">// If only unsized formats are supported, there is no point in</span></div>
<div class="line">        <span class="comment">// converting as the modern formats aren&#39;t supported either.</span></div>
<div class="line">        <span class="keywordflow">if</span> (sizedFormats == _NON_LEGACY_FORMATS &amp;&amp; supportsSwizzle) {</div>
<div class="line">            convertFormat(target, &amp;cbData.glFormat, &amp;cbData.glInternalformat);</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sizedFormats == _NO_SIZED_FORMATS)</div>
<div class="line">            cbData.glInternalformat = formatInfo-&gt;<a id="a17" name="a17"></a>glBaseInternalformat;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">        <span class="comment">// When no sized formats are supported, or legacy sized formats are not</span></div>
<div class="line">        <span class="comment">// supported, must change internal format.</span></div>
<div class="line">        <span class="keywordflow">if</span> (sizedFormats == _NO_SIZED_FORMATS</div>
<div class="line">            || (!(sizedFormats &amp; _LEGACY_FORMATS) &amp;&amp;</div>
<div class="line">                (formatInfo-&gt;glBaseInternalformat == GL_ALPHA</div>
<div class="line">                || formatInfo-&gt;glBaseInternalformat == GL_LUMINANCE</div>
<div class="line">                || formatInfo-&gt;glBaseInternalformat == GL_LUMINANCE_ALPHA</div>
<div class="line">                || formatInfo-&gt;glBaseInternalformat == GL_INTENSITY))) {</div>
<div class="line">            cbData.glInternalformat = formatInfo-&gt;glBaseInternalformat;</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ktxTexture_isActiveStream(<a class="code hl_class" href="structktxTexture.html">ktxTexture</a>(This)))</div>
<div class="line">        result = ktxTexture_IterateLoadLevelFaces(This, iterCb, &amp;cbData);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        result = ktxTexture_IterateLevelFaces(This, iterCb, &amp;cbData);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* GL errors are the only reason for failure. */</span></div>
<div class="line">    <span class="keywordflow">if</span> (result != KTX_SUCCESS &amp;&amp; cbData.glError != GL_NO_ERROR) {</div>
<div class="line">        <span class="keywordflow">if</span> (pGlerror)</div>
<div class="line">            *pGlerror = cbData.glError;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (result == KTX_SUCCESS)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Prefer glGenerateMipmaps over GL_GENERATE_MIPMAP</span></div>
<div class="line">        <span class="keywordflow">if</span> (This-&gt;<a class="code hl_variable" href="structktxTexture.html#a4159f859437a820d7984beda366e2eaa">generateMipmaps</a> &amp;&amp; gl.glGenerateMipmap) {</div>
<div class="line">            gl.glGenerateMipmap(target);</div>
<div class="line">        }</div>
<div class="line">        *pTarget = target;</div>
<div class="line">        <span class="keywordflow">if</span> (pTexture) {</div>
<div class="line">            *pTexture = texname;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!texnameUser) {</div>
<div class="line">        glDeleteTextures(1, &amp;texname);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"><span class="comment">/* [loadGLTexture] */</span></div>
<div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">ktxTexture1_GLUpload(<a id="_a18" name="_a18"></a><a class="code hl_class" href="structktxTexture1.html">ktxTexture1</a>* This, GLuint* pTexture, GLenum* pTarget,</div>
<div class="line">                     GLenum* pGlerror)</div>
<div class="line">{</div>
<div class="line">    GLint                 previousUnpackAlignment;</div>
<div class="line">    KTX_error_code        result = KTX_SUCCESS;</div>
<div class="line">    ktx_glformatinfo      formatInfo;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!This) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_INVALID_VALUE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pTarget) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_INVALID_VALUE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!ktxOpenGLModuleHandle) {</div>
<div class="line">        result = ktxLoadOpenGLLibrary();</div>
<div class="line">        <span class="keywordflow">if</span> (result != KTX_SUCCESS) {</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* KTX 1 files require an unpack alignment of 4 */</span></div>
<div class="line">    glGetIntegerv(GL_UNPACK_ALIGNMENT, &amp;previousUnpackAlignment);</div>
<div class="line">    <span class="keywordflow">if</span> (previousUnpackAlignment != KTX_GL_UNPACK_ALIGNMENT) {</div>
<div class="line">        glPixelStorei(GL_UNPACK_ALIGNMENT, KTX_GL_UNPACK_ALIGNMENT);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    formatInfo.glFormat = This-&gt;<a id="a19" name="a19"></a><a class="code hl_variable" href="structktxTexture1.html#a05fa4fecc2735f68d34651a62493ecd9">glFormat</a>;</div>
<div class="line">    formatInfo.glInternalformat = This-&gt;<a id="a20" name="a20"></a><a class="code hl_variable" href="structktxTexture1.html#a1318d73f800ff61d045b740331939596">glInternalformat</a>;</div>
<div class="line">    formatInfo.glBaseInternalformat = This-&gt;<a id="a21" name="a21"></a><a class="code hl_variable" href="structktxTexture1.html#aaadefe13bf76c26cb921afa52fb29192">glBaseInternalformat</a>;</div>
<div class="line">    formatInfo.glType = This-&gt;<a id="a22" name="a22"></a><a class="code hl_variable" href="structktxTexture1.html#ac8a870c675f1e36c456c9de2e3ac9855">glType</a>;</div>
<div class="line"> </div>
<div class="line">    result = ktxTexture_GLUploadPrivate(<a class="code hl_class" href="structktxTexture.html">ktxTexture</a>(This), &amp;formatInfo,</div>
<div class="line">                                        pTexture, pTarget, pGlerror);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* restore previous GL state */</span></div>
<div class="line">    <span class="keywordflow">if</span> (previousUnpackAlignment != KTX_GL_UNPACK_ALIGNMENT) {</div>
<div class="line">        glPixelStorei(GL_UNPACK_ALIGNMENT, previousUnpackAlignment);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">ktxTexture2_GLUpload(<a id="_a23" name="_a23"></a><a class="code hl_class" href="structktxTexture2.html">ktxTexture2</a>* This, GLuint* pTexture, GLenum* pTarget,</div>
<div class="line">                     GLenum* pGlerror)</div>
<div class="line">{</div>
<div class="line">    GLint                 previousUnpackAlignment;</div>
<div class="line">    ktx_error_code_e      result = KTX_SUCCESS;</div>
<div class="line">    ktx_glformatinfo      formatInfo;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!This) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_INVALID_VALUE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pTarget) {</div>
<div class="line">        <span class="keywordflow">return</span> KTX_INVALID_VALUE;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!ktxOpenGLModuleHandle) {</div>
<div class="line">        result = ktxLoadOpenGLLibrary();</div>
<div class="line">        <span class="keywordflow">if</span> (result != KTX_SUCCESS) {</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (This-&gt;<a id="a24" name="a24"></a>vkFormat != VK_FORMAT_UNDEFINED) {</div>
<div class="line">        formatInfo.glInternalformat =</div>
<div class="line">                            vkFormat2glInternalFormat(This-&gt;vkFormat);</div>
<div class="line">        <span class="keywordflow">if</span> (formatInfo.glInternalformat == GL_INVALID_VALUE) {</div>
<div class="line">            <span class="comment">// TODO Check for mapping metadata. If none</span></div>
<div class="line">            <span class="keywordflow">return</span> KTX_INVALID_OPERATION;</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">       <span class="comment">// TODO: Check DFD for ASTC HDR or 3D or RGB[DEM] and figure out format.</span></div>
<div class="line">       <span class="keywordflow">return</span> KTX_INVALID_OPERATION; <span class="comment">// BasisU textures must be transcoded</span></div>
<div class="line">                                     <span class="comment">// before upload.</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (This-&gt;<a id="a25" name="a25"></a>isCompressed) {</div>
<div class="line">        <span class="comment">/* Unused. */</span></div>
<div class="line">        formatInfo.glFormat = GL_INVALID_VALUE;</div>
<div class="line">        formatInfo.glType = GL_INVALID_VALUE;</div>
<div class="line">        formatInfo.glBaseInternalformat = GL_INVALID_VALUE;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        formatInfo.glFormat = vkFormat2glFormat(This-&gt;vkFormat);</div>
<div class="line">        formatInfo.glType = vkFormat2glType(This-&gt;vkFormat);</div>
<div class="line">        formatInfo.glBaseInternalformat = formatInfo.glInternalformat;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (formatInfo.glFormat == GL_INVALID_VALUE || formatInfo.glType == GL_INVALID_VALUE)</div>
<div class="line">            <span class="keywordflow">return</span> KTX_INVALID_OPERATION;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* KTX 2 files require an unpack alignment of 1. OGL default is 4. */</span></div>
<div class="line">    glGetIntegerv(GL_UNPACK_ALIGNMENT, &amp;previousUnpackAlignment);</div>
<div class="line">    <span class="keywordflow">if</span> (previousUnpackAlignment != 1) {</div>
<div class="line">        glPixelStorei(GL_UNPACK_ALIGNMENT, 1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    result = ktxTexture_GLUploadPrivate(<a class="code hl_class" href="structktxTexture.html">ktxTexture</a>(This), &amp;formatInfo,</div>
<div class="line">                                        pTexture, pTarget, pGlerror);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* restore previous GL state */</span></div>
<div class="line">    <span class="keywordflow">if</span> (previousUnpackAlignment != 1) {</div>
<div class="line">        glPixelStorei(GL_UNPACK_ALIGNMENT, previousUnpackAlignment);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> result;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">KTX_error_code</div>
<div class="line">ktxTexture_GLUpload(<a class="code hl_class" href="structktxTexture.html">ktxTexture</a>* This, GLuint* pTexture, GLenum* pTarget,</div>
<div class="line">                    GLenum* pGlerror)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (This-&gt;<a id="a26" name="a26"></a><a class="code hl_variable" href="structktxTexture.html#ac838c216df52582085ca9e1eb6d19d07">classId</a> == ktxTexture2_c)</div>
<div class="line">        <span class="keywordflow">return</span> ktxTexture2_GLUpload((<a class="code hl_class" href="structktxTexture2.html">ktxTexture2</a>*)This, pTexture, pTarget,</div>
<div class="line">                                     pGlerror);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">return</span> ktxTexture1_GLUpload((<a class="code hl_class" href="structktxTexture1.html">ktxTexture1</a>*)This, pTexture, pTarget,</div>
<div class="line">                                     pGlerror);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="ttc" id="astructktxTexture1_html"><div class="ttname"><a href="structktxTexture1.html">ktxTexture1</a></div><div class="ttdoc">Class representing a KTX version 1 format texture.</div><div class="ttdef"><b>Definition</b> ktx.h:632</div></div>
<div class="ttc" id="astructktxTexture1_html_a05fa4fecc2735f68d34651a62493ecd9"><div class="ttname"><a href="structktxTexture1.html#a05fa4fecc2735f68d34651a62493ecd9">ktxTexture1::glFormat</a></div><div class="ttdeci">ktx_uint32_t glFormat</div><div class="ttdef"><b>Definition</b> ktx.h:634</div></div>
<div class="ttc" id="astructktxTexture1_html_a1318d73f800ff61d045b740331939596"><div class="ttname"><a href="structktxTexture1.html#a1318d73f800ff61d045b740331939596">ktxTexture1::glInternalformat</a></div><div class="ttdeci">ktx_uint32_t glInternalformat</div><div class="ttdef"><b>Definition</b> ktx.h:635</div></div>
<div class="ttc" id="astructktxTexture1_html_aaadefe13bf76c26cb921afa52fb29192"><div class="ttname"><a href="structktxTexture1.html#aaadefe13bf76c26cb921afa52fb29192">ktxTexture1::glBaseInternalformat</a></div><div class="ttdeci">ktx_uint32_t glBaseInternalformat</div><div class="ttdef"><b>Definition</b> ktx.h:637</div></div>
<div class="ttc" id="astructktxTexture1_html_ac8a870c675f1e36c456c9de2e3ac9855"><div class="ttname"><a href="structktxTexture1.html#ac8a870c675f1e36c456c9de2e3ac9855">ktxTexture1::glType</a></div><div class="ttdeci">ktx_uint32_t glType</div><div class="ttdef"><b>Definition</b> ktx.h:639</div></div>
<div class="ttc" id="astructktxTexture2_html"><div class="ttname"><a href="structktxTexture2.html">ktxTexture2</a></div><div class="ttdoc">Class representing a KTX version 2 format texture.</div><div class="ttdef"><b>Definition</b> ktx.h:675</div></div>
<div class="ttc" id="astructktxTexture_html"><div class="ttname"><a href="structktxTexture.html">ktxTexture</a></div><div class="ttdoc">Base class representing a texture.</div><div class="ttdef"><b>Definition</b> ktx.h:263</div></div>
<div class="ttc" id="astructktxTexture_html_a4159f859437a820d7984beda366e2eaa"><div class="ttname"><a href="structktxTexture.html#a4159f859437a820d7984beda366e2eaa">ktxTexture::generateMipmaps</a></div><div class="ttdeci">ktx_bool_t generateMipmaps</div><div class="ttdef"><b>Definition</b> ktx.h:264</div></div>
<div class="ttc" id="astructktxTexture_html_aad80dfe68bfa0c1ddcc127c4c6e1dda8"><div class="ttname"><a href="structktxTexture.html#aad80dfe68bfa0c1ddcc127c4c6e1dda8">ktxTexture::numLevels</a></div><div class="ttdeci">ktx_uint32_t numLevels</div><div class="ttdoc">Number of mip levels in the texture.</div><div class="ttdef"><b>Definition</b> ktx.h:264</div></div>
<div class="ttc" id="astructktxTexture_html_ac838c216df52582085ca9e1eb6d19d07"><div class="ttname"><a href="structktxTexture.html#ac838c216df52582085ca9e1eb6d19d07">ktxTexture::classId</a></div><div class="ttdeci">class_id classId</div><div class="ttdoc">Identify the class type.</div><div class="ttdef"><b>Definition</b> ktx.h:264</div></div>
<div class="ttc" id="astructktxTexture_html_acc36239d64c8e0562a7a14ccd140af70"><div class="ttname"><a href="structktxTexture.html#acc36239d64c8e0562a7a14ccd140af70">ktxTexture::numFaces</a></div><div class="ttdeci">ktx_uint32_t numFaces</div><div class="ttdoc">Number of faces: 6 for cube maps, 1 otherwise.</div><div class="ttdef"><b>Definition</b> ktx.h:264</div></div>
<div class="ttc" id="astructktxTexture_html_ae4378ab23f88acb257e6b4c1d8f64bb8"><div class="ttname"><a href="structktxTexture.html#ae4378ab23f88acb257e6b4c1d8f64bb8">ktxTexture::numDimensions</a></div><div class="ttdeci">ktx_uint32_t numDimensions</div><div class="ttdoc">Number of dimensions in the texture: 1, 2 or 3.</div><div class="ttdef"><b>Definition</b> ktx.h:264</div></div>
<div class="ttc" id="astructktxTexture_html_ae904839d65da570a3b066a93e4573dab"><div class="ttname"><a href="structktxTexture.html#ae904839d65da570a3b066a93e4573dab">ktxTexture::isArray</a></div><div class="ttdeci">ktx_bool_t isArray</div><div class="ttdef"><b>Definition</b> ktx.h:264</div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Mar 20 2024 15:46:14 for libktx Reference by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
